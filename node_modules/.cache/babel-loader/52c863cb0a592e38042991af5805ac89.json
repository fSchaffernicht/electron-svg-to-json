{"ast":null,"code":"'use strict';\n\nexports.type = 'perItem';\nexports.active = true;\nexports.description = 'removes useless stroke and fill attributes';\nexports.params = {\n  stroke: true,\n  fill: true\n};\n\nvar shape = require('./_collections').elemsGroups.shape,\n    regStrokeProps = /^stroke/,\n    regFillProps = /^fill-/,\n    styleOrScript = ['style', 'script'],\n    hasStyleOrScript = false;\n/**\n * Remove useless stroke and fill attrs.\n *\n * @param {Object} item current iteration item\n * @param {Object} params plugin params\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\n\n\nexports.fn = function (item, params) {\n  if (item.isElem(styleOrScript)) {\n    hasStyleOrScript = true;\n  }\n\n  if (!hasStyleOrScript && item.isElem(shape) && !item.computedAttr('id')) {\n    var stroke = params.stroke && item.computedAttr('stroke'),\n        fill = params.fill && !item.computedAttr('fill', 'none'); // remove stroke*\n\n    if (params.stroke && (!stroke || stroke == 'none' || item.computedAttr('stroke-opacity', '0') || item.computedAttr('stroke-width', '0'))) {\n      var parentStroke = item.parentNode.computedAttr('stroke'),\n          declineStroke = parentStroke && parentStroke != 'none';\n      item.eachAttr(function (attr) {\n        if (regStrokeProps.test(attr.name)) {\n          item.removeAttr(attr.name);\n        }\n      });\n      if (declineStroke) item.addAttr({\n        name: 'stroke',\n        value: 'none',\n        prefix: '',\n        local: 'stroke'\n      });\n    } // remove fill*\n\n\n    if (params.fill && (!fill || item.computedAttr('fill-opacity', '0'))) {\n      item.eachAttr(function (attr) {\n        if (regFillProps.test(attr.name)) {\n          item.removeAttr(attr.name);\n        }\n      });\n\n      if (fill) {\n        if (item.hasAttr('fill')) item.attr('fill').value = 'none';else item.addAttr({\n          name: 'fill',\n          value: 'none',\n          prefix: '',\n          local: 'fill'\n        });\n      }\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"script"}