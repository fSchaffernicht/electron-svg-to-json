{"ast":null,"code":"'use strict';\n\nexports.type = 'perItem';\nexports.active = true;\nexports.description = 'removes elements in <defs> without id';\n\nvar nonRendering = require('./_collections').elemsGroups.nonRendering,\n    defs;\n/**\n * Removes content of defs and properties that aren't rendered directly without ids.\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Lev Solntsev\n */\n\n\nexports.fn = function (item) {\n  if (item.isElem('defs')) {\n    defs = item;\n    item.content = (item.content || []).reduce(getUsefulItems, []);\n    if (item.isEmpty()) return false;\n  } else if (item.isElem(nonRendering) && !item.hasAttr('id')) {\n    return false;\n  }\n};\n\nfunction getUsefulItems(usefulItems, item) {\n  if (item.hasAttr('id') || item.isElem('style')) {\n    usefulItems.push(item);\n    item.parentNode = defs;\n  } else if (!item.isEmpty()) {\n    item.content.reduce(getUsefulItems, usefulItems);\n  }\n\n  return usefulItems;\n}","map":null,"metadata":{},"sourceType":"script"}