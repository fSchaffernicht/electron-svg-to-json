{"ast":null,"code":"'use strict';\n\nexports.type = 'full';\nexports.active = true;\nexports.description = 'removes unused namespaces declaration';\n/**\n * Remove unused namespaces declaration.\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\n\nexports.fn = function (data) {\n  var svgElem,\n      xmlnsCollection = [];\n  /**\n   * Remove namespace from collection.\n   *\n   * @param {String} ns namescape name\n   */\n\n  function removeNSfromCollection(ns) {\n    var pos = xmlnsCollection.indexOf(ns); // if found - remove ns from the namespaces collection\n\n    if (pos > -1) {\n      xmlnsCollection.splice(pos, 1);\n    }\n  }\n  /**\n   * Bananas!\n   *\n   * @param {Array} items input items\n   *\n   * @return {Array} output items\n   */\n\n\n  function monkeys(items) {\n    var i = 0,\n        length = items.content.length;\n\n    while (i < length) {\n      var item = items.content[i];\n\n      if (item.isElem('svg')) {\n        item.eachAttr(function (attr) {\n          // collect namespaces\n          if (attr.prefix === 'xmlns' && attr.local) {\n            xmlnsCollection.push(attr.local);\n          }\n        }); // if svg element has ns-attr\n\n        if (xmlnsCollection.length) {\n          // save svg element\n          svgElem = item;\n        }\n      } else if (xmlnsCollection.length) {\n        // check item for the ns-attrs\n        if (item.prefix) {\n          removeNSfromCollection(item.prefix);\n        } // check each attr for the ns-attrs\n\n\n        item.eachAttr(function (attr) {\n          removeNSfromCollection(attr.prefix);\n        });\n      } // if nothing is found - go deeper\n\n\n      if (xmlnsCollection.length && item.content) {\n        monkeys(item);\n      }\n\n      i++;\n    }\n\n    return items;\n  }\n\n  data = monkeys(data); // remove svg element ns-attributes if they are not used even once\n\n  if (xmlnsCollection.length) {\n    xmlnsCollection.forEach(function (name) {\n      svgElem.removeAttr('xmlns:' + name);\n    });\n  }\n\n  return data;\n};","map":null,"metadata":{},"sourceType":"script"}