{"ast":null,"code":"'use strict';\n\nexports.type = 'full';\nexports.active = true;\nexports.description = 'remove or cleanup enable-background attribute when possible';\n/**\n * Remove or cleanup enable-background attr which coincides with a width/height box.\n *\n * @see http://www.w3.org/TR/SVG/filters.html#EnableBackgroundProperty\n *\n * @example\n * <svg width=\"100\" height=\"50\" enable-background=\"new 0 0 100 50\">\n *             â¬‡\n * <svg width=\"100\" height=\"50\">\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\n\nexports.fn = function (data) {\n  var regEnableBackground = /^new\\s0\\s0\\s([\\-+]?\\d*\\.?\\d+([eE][\\-+]?\\d+)?)\\s([\\-+]?\\d*\\.?\\d+([eE][\\-+]?\\d+)?)$/,\n      hasFilter = false,\n      elems = ['svg', 'mask', 'pattern'];\n\n  function checkEnableBackground(item) {\n    if (item.isElem(elems) && item.hasAttr('enable-background') && item.hasAttr('width') && item.hasAttr('height')) {\n      var match = item.attr('enable-background').value.match(regEnableBackground);\n\n      if (match) {\n        if (item.attr('width').value === match[1] && item.attr('height').value === match[3]) {\n          if (item.isElem('svg')) {\n            item.removeAttr('enable-background');\n          } else {\n            item.attr('enable-background').value = 'new';\n          }\n        }\n      }\n    }\n  }\n\n  function checkForFilter(item) {\n    if (item.isElem('filter')) {\n      hasFilter = true;\n    }\n  }\n\n  function monkeys(items, fn) {\n    items.content.forEach(function (item) {\n      fn(item);\n\n      if (item.content) {\n        monkeys(item, fn);\n      }\n    });\n    return items;\n  }\n\n  var firstStep = monkeys(data, function (item) {\n    checkEnableBackground(item);\n\n    if (!hasFilter) {\n      checkForFilter(item);\n    }\n  });\n  return hasFilter ? firstStep : monkeys(firstStep, function (item) {\n    //we don't need 'enable-background' if we have no filters\n    item.removeAttr('enable-background');\n  });\n};","map":null,"metadata":{},"sourceType":"script"}